import{_ as s,c as a,o as n,e as l}from"./app.720d6a15.js";const i=JSON.parse('{"title":"Rustå®å­¦ä¹ ç¬”è®°","description":"Keep Learningï¼","frontmatter":{"title":"Rustå®å­¦ä¹ ç¬”è®°","description":"Keep Learningï¼","tags":["Rust","å®å­¦å®¶"]},"headers":[{"level":2,"title":"Rustä¸­å®çš„åˆ†ç±»","slug":"rustä¸­å®çš„åˆ†ç±»","link":"#rustä¸­å®çš„åˆ†ç±»","children":[]},{"level":2,"title":"å£°æ˜å¼å®","slug":"å£°æ˜å¼å®","link":"#å£°æ˜å¼å®","children":[]},{"level":2,"title":"è¿‡ç¨‹å¼å®","slug":"è¿‡ç¨‹å¼å®","link":"#è¿‡ç¨‹å¼å®","children":[{"level":3,"title":"Custom Derive å®","slug":"custom-derive-å®","link":"#custom-derive-å®","children":[]},{"level":3,"title":"Attribute-Like å®","slug":"attribute-like-å®","link":"#attribute-like-å®","children":[]},{"level":3,"title":"Function-Like å®","slug":"function-like-å®","link":"#function-like-å®","children":[]}]},{"level":2,"title":"å¥½ç”¨çš„åº“","slug":"å¥½ç”¨çš„åº“","link":"#å¥½ç”¨çš„åº“","children":[]},{"level":2,"title":"MacroKata","slug":"macrokata","link":"#macrokata","children":[]},{"level":2,"title":"æ”¶å½•æœ‰è¶£çš„å®æ ·ä¾‹","slug":"æ”¶å½•æœ‰è¶£çš„å®æ ·ä¾‹","link":"#æ”¶å½•æœ‰è¶£çš„å®æ ·ä¾‹","children":[{"level":3,"title":"ä½ è¿™å†™çš„å•¥å•Š","slug":"ä½ è¿™å†™çš„å•¥å•Š","link":"#ä½ è¿™å†™çš„å•¥å•Š","children":[]},{"level":3,"title":"è¿˜å¾—å­¦ä¹ ä¸€ä¸ª","slug":"è¿˜å¾—å­¦ä¹ ä¸€ä¸ª","link":"#è¿˜å¾—å­¦ä¹ ä¸€ä¸ª","children":[]}]},{"level":2,"title":"References","slug":"references","link":"#references","children":[]}],"relativePath":"zh/blogs/20210224/index.md"}'),p={name:"zh/blogs/20210224/index.md"},o=l(`<nav class="table-of-contents"><ul><li><a href="#rustä¸­å®çš„åˆ†ç±»">Rustä¸­å®çš„åˆ†ç±»</a></li><li><a href="#å£°æ˜å¼å®">å£°æ˜å¼å®</a></li><li><a href="#è¿‡ç¨‹å¼å®">è¿‡ç¨‹å¼å®</a><ul><li><a href="#custom-derive-å®">Custom Derive å®</a></li><li><a href="#attribute-like-å®">Attribute-Like å®</a></li><li><a href="#function-like-å®">Function-Like å®</a></li></ul></li><li><a href="#å¥½ç”¨çš„åº“">å¥½ç”¨çš„åº“</a></li><li><a href="#macrokata">MacroKata</a></li><li><a href="#æ”¶å½•æœ‰è¶£çš„å®æ ·ä¾‹">æ”¶å½•æœ‰è¶£çš„å®æ ·ä¾‹</a><ul><li><a href="#ä½ è¿™å†™çš„å•¥å•Š">ä½ è¿™å†™çš„å•¥å•Š</a></li><li><a href="#è¿˜å¾—å­¦ä¹ ä¸€ä¸ª">è¿˜å¾—å­¦ä¹ ä¸€ä¸ª</a></li></ul></li><li><a href="#references">References</a></li></ul></nav><h1 id="rustå®å­¦ä¹ ç¬”è®°" tabindex="-1">Rustå®å­¦ä¹ ç¬”è®° <a class="header-anchor" href="#rustå®å­¦ä¹ ç¬”è®°" aria-hidden="true">#</a></h1><p>å‰é¢çš„éƒ¨åˆ†åŸºæœ¬æ˜¯ Rust è¯­è¨€æ‰‹å†Œç¿»è¯‘ã€‚</p><p>Rust ä¸­çš„å®ç›¸è¾ƒC++æ›´ä¸ºå¼ºå¤§ã€‚C++ ä¸­çš„å®åœ¨é¢„å¤„ç†é˜¶æ®µå¯ä»¥å±•å¼€ä¸ºæ–‡æœ¬ï¼ŒRust çš„å®åˆ™æ˜¯å¯¹è¯­æ³•çš„æ‰©å±•ï¼Œæ˜¯åœ¨æ„å»ºè¯­æ³•æ ‘æ—¶ï¼Œæ‰å±•å¼€çš„å®ã€‚</p><h2 id="rustä¸­å®çš„åˆ†ç±»" tabindex="-1">Rustä¸­å®çš„åˆ†ç±» <a class="header-anchor" href="#rustä¸­å®çš„åˆ†ç±»" aria-hidden="true">#</a></h2><p>Rust ä¸­å®å¯ä»¥åˆ†ä¸ºå¾ˆå¤šç±»ï¼ŒåŒ…æ‹¬é€šè¿‡ macro_rules å®šä¹‰çš„<strong>å£°æ˜å¼å®</strong>å’Œä¸‰ç§<strong>è¿‡ç¨‹å¼å®</strong></p><ul><li>custom derive å¯æ¨å¯¼å®ï¼Œå€ŸåŠ© <code>#[derive]</code> å±æ€§æ ‡ç­¾ï¼Œå®ƒå¯ä»¥ç”¨åœ¨ struct å’Œ enum ä¸Š</li><li>attribute-like æœ¬èº«å°±æ˜¯ä¸€ä¸ªæ ‡ç­¾ï¼Œå¯ä»¥ä½œç”¨äºä»»ä½•åœ°æ–¹</li><li>function-like çœ‹ä¸Šå»åƒå‡½æ•°ï¼Œä½†æ˜¯ä½œç”¨åœ¨ token ä¸Šï¼Œå³æŠŠtokenä½œä¸ºå‡½æ•°å‚æ•°</li></ul><p>æ‰€ä»¥ä¸ºä»€ä¹ˆéœ€è¦å®ï¼Ÿ</p><p>ä¸ºäº†å·æ‡’ã€ä¸ºäº†è®©ä»£ç æ›´ç®€æ´ã€‚ä½¿ç”¨å®å¯ä»¥å¿«é€Ÿç”Ÿæˆå¤§é‡ä»£ç ï¼Œé¿å…é‡å¤åŠ³åŠ¨ã€‚Rust å®æ‰©å±•äº†è¯­æ³•ï¼Œä½ æ˜¯ä¸ä¼šæƒ³è¦æ¯æ¬¡éƒ½è€è€å®å®åœ°å†™ç¹å¤çš„ä»£ç çš„ï¼Œæ‰€ä»¥å­¦ä¸€ç‚¹é­”æ³•ï¼</p><p>ä¸ºä»€ä¹ˆä¸ç”¨å‡½æ•°æˆ–è€…æ¨¡æ¿ï¼Ÿ</p><ul><li>Rust çš„å‡½æ•°å¿…é¡»é™å®šå¥½å‚æ•°ç±»å‹å’Œå‚æ•°ä¸ªæ•°ï¼Œè€Œä¸”ä»–å¹¶æ²¡æœ‰æä¾›å˜é•¿æ¨¡æ¿å‚æ•°ï¼Œæ‰€ä»¥å˜›ï¼Œå“ˆå“ˆã€‚äº‹å®ä¸Šæœ‰ä¸å°‘åº“ä¸ºäº†åº”å¯¹æœªçŸ¥ä¸ªæ•°å‚æ•°çš„æƒ…å†µï¼Œæ‰‹å†™äº†ä¸åŒä¸ªæ•°å‚æ•°çš„å‡½æ•°ï¼Œè€Œä¸”å¾ˆè›‹ç–¼çš„æ˜¯ Rust ä¹Ÿä¸å…è®¸åŒåå‡½æ•°çš„é‡è½½ ğŸ˜ƒ å½“ç„¶æˆ‘è¿˜æ˜¯æœ€å–œæ¬¢Rustäº†ã€‚</li><li>å®åœ¨ç¼–è¯‘æœŸå±•å¼€ï¼Œæ‰€ä»¥å¯ä»¥ç”¨æ¥ç»™ struct æ·»åŠ  traitï¼Œè¿™å¿…é¡»åœ¨è¿è¡Œå‰å®Œæˆï¼Œè€Œå‡½æ•°éœ€è¦ç­‰åˆ°è¿è¡Œæ—¶æ‰ä¼šæ‰§è¡Œã€‚</li></ul><p>ä½†æ˜¯åå¤„ï¼ˆå¦‚æœç®—çš„è¯ï¼‰å°±æ˜¯å®æ›´éš¾ä¹¦å†™ã€ç†è§£å’Œç»´æŠ¤ï¼›åŒæ—¶å‡½æ•°å¯ä»¥å®šä¹‰ã€å¼•å…¥åœ¨æ–‡ä»¶é‡Œçš„ä»»ä½•åœ°æ–¹ï¼Œè€Œåœ¨ä½¿ç”¨å®ä¹‹å‰å¿…é¡»ç¡®ä¿ä»–è¢«å®šä¹‰ã€å¼•å…¥åˆ°ä¸Šæ–¹çš„ä»£ç ä¸­äº†ã€‚</p><p>ä¸‹é¢å¼€å§‹è®°å½•å®çš„å†™æ³•ï¼</p><h2 id="å£°æ˜å¼å®" tabindex="-1">å£°æ˜å¼å® <a class="header-anchor" href="#å£°æ˜å¼å®" aria-hidden="true">#</a></h2><p>åœ¨Rustä¸­ï¼Œåº”ç”¨æœ€å¹¿æ³›çš„ä¸€ç§å®å°±æ˜¯å£°æ˜å¼å®ï¼Œç±»ä¼¼äºæ¨¡å¼åŒ¹é…çš„å†™æ³•ï¼Œå°†ä¼ å…¥çš„ Rust ä»£ç ä¸é¢„å…ˆæŒ‡å®šçš„æ¨¡å¼è¿›è¡Œæ¯”è¾ƒï¼Œåœ¨ä¸åŒæ¨¡å¼ä¸‹ç”Ÿæˆä¸åŒçš„ä»£ç ã€‚</p><p>ä½¿ç”¨<code>macro_rules!</code>æ¥å®šä¹‰ä¸€ä¸ªå£°æ˜å¼å®ã€‚</p><p>æœ€åŸºç¡€çš„ä¾‹å­æ˜¯å¾ˆå¸¸è§çš„<code>vec!</code>ï¼š</p><div class="language-rust"><button title="Copy Code" class="copy"></button><span class="lang">rust</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#C792EA;">let</span><span style="color:#A6ACCD;"> v</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Vec</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">u32</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">vec!</span><span style="color:#89DDFF;">[</span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">2</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">3</span><span style="color:#89DDFF;">];</span></span>
<span class="line"></span></code></pre></div><p>ç®€åŒ–ç‰ˆçš„å®šä¹‰æ˜¯ï¼ˆå®é™…çš„ç‰ˆæœ¬æœ‰å…¶ä»–åˆ†æ”¯ï¼Œè€Œä¸”è¯¥åˆ†æ”¯ä¸‹è¦é¢„å…ˆåˆ†é…å†…å­˜é˜²æ­¢åœ¨pushæ—¶å€™å†åŠ¨æ€åˆ†åˆ’ï¼‰</p><div class="language-rust"><button title="Copy Code" class="copy"></button><span class="lang">rust</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#89DDFF;">#[</span><span style="color:#A6ACCD;">macro_export</span><span style="color:#89DDFF;">]</span></span>
<span class="line"><span style="color:#82AAFF;">macro_rules!</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">vec</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">$(</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">x</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;">expr </span><span style="color:#89DDFF;">),*</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#C792EA;">let</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">mut</span><span style="color:#A6ACCD;"> temp_vec </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Vec</span><span style="color:#89DDFF;">::</span><span style="color:#82AAFF;">new</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;">$(</span></span>
<span class="line"><span style="color:#A6ACCD;">                temp_vec</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">push</span><span style="color:#89DDFF;">($</span><span style="color:#A6ACCD;">x</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;">)*</span></span>
<span class="line"><span style="color:#A6ACCD;">            temp_vec</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">};</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><p>::: <code>$( $x:expr ),*</code>å’Œ<code>$( $x:expr,)*</code>çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</p><p>å‰è€…ï¼Œæœ€åçš„<code>,</code>æ˜¯<a href="https://doc.rust-lang.org/reference/macros-by-example.html" target="_blank" rel="noreferrer"><strong>MacroRepSep</strong></a>ï¼Œæ„å‘³ç€ <code>1,2,3</code>æ˜¯ä¸€ä¸ªåˆæ³•çš„åºåˆ—ã€‚</p><p>åè€…ï¼Œæœ€åçš„<code>,</code>æ˜¯<a href="https://doc.rust-lang.org/reference/macros-by-example.html" target="_blank" rel="noreferrer"><strong>MacroMatch</strong></a> çš„ä¸€éƒ¨åˆ†ï¼Œæ„å‘³ç€ <code>1,2,3,</code>æ‰æ˜¯ä¸€ä¸ªåˆæ³•çš„åºåˆ—ã€‚</p><p>:::</p><p><code>#[macro_export]</code>æ ‡ç­¾æ˜¯ç”¨æ¥å£°æ˜ï¼šåªè¦ use äº†è¿™ä¸ªcrateï¼Œå°±å¯ä»¥ä½¿ç”¨è¯¥å®ã€‚åŒæ—¶åŒ…å«è¢« export å‡ºçš„å®çš„æ¨¡å—ï¼Œåœ¨å£°æ˜æ—¶å¿…é¡»æ”¾åœ¨å‰é¢ï¼Œå¦åˆ™é å‰çš„æ¨¡å—é‡Œæ‰¾ä¸åˆ°è¿™äº›å®ã€‚</p><p>æŒ‰ç…§å®˜æ–¹æ–‡æ¡£çš„è¯´æ³•ï¼Œ<code>macro_rules!</code>ç›®å‰æœ‰ä¸€äº›è®¾è®¡ä¸Šçš„é—®é¢˜ï¼Œæ—¥åå°†æ¨å‡ºæ–°çš„æœºåˆ¶æ¥å–ä»£ä»–ã€‚ä½†æ˜¯ä»–ä¾ç„¶æ˜¯ä¸€ä¸ªå¾ˆæœ‰æ•ˆçš„è¯­æ³•æ‰©å±•æ–¹æ³•ã€‚</p><p>è¿™é‡Œä¸€ä¸ªæ³¨æ„ç‚¹æ˜¯ï¼šå¦‚æœæƒ³è¦åˆ›å»ºä¸´æ—¶å˜é‡ï¼Œé‚£ä¹ˆå¿…é¡»è¦åƒä¸Šé¢è¿™ä¸ªä¾‹å­è¿™æ ·ï¼Œæ”¾åœ¨æŸä¸ªå—çº§ä½œç”¨åŸŸå†…ï¼Œä»¥ä¾¿è‡ªåŠ¨æ¸…ç†æ‰ï¼Œå¦åˆ™ä¼šè®¤ä¸ºæ˜¯ä¸å®‰å…¨çš„è¡Œä¸ºã€‚</p><p>:::å£°æ˜å®ä¸­æ”¯æŒçš„è¯­æ³•æ ‘å…ƒå˜é‡ç±»å‹</p><p>å‡ºè‡ª <a href="https://doc.rust-lang.org/reference/macros-by-example.html#metavariables" target="_blank" rel="noreferrer">Macros By Example - The Rust Reference</a>ã€‚</p><p>å›é¡¾ç¼–è¯‘åŸç† ğŸ˜ƒ</p><ul><li><code>item</code>: éšä¾¿ä¸€ä¸ªä»€ä¹ˆ <a href="https://doc.rust-lang.org/reference/items.html" target="_blank" rel="noreferrer">ä¸œè¥¿</a>ï¼Œå‡†ç¡®å®šä¹‰å‚è€ƒä¸Šè¿°æ‰‹å†Œä¸­</li><li><code>block</code>: ä¸€ä¸ª <a href="https://doc.rust-lang.org/reference/expressions/block-expr.html" target="_blank" rel="noreferrer">å—è¡¨è¾¾å¼</a></li><li><code>stmt</code>: ä¸€ä¸ª <a href="https://doc.rust-lang.org/reference/statements.html" target="_blank" rel="noreferrer">è¯­å¥</a>ï¼Œä½†æ˜¯ä¸åŒ…å«ç»“å°¾çš„åˆ†å·ï¼Œé™¤äº†å¿…é¡»æœ‰åˆ†å·çš„ item statements</li><li><code>pat_param</code>: ä¸€ä¸ª <a href="https://doc.rust-lang.org/reference/patterns.html" target="_blank" rel="noreferrer">åŒ¹é…æ¨¡å¼</a></li><li><code>pat</code>: ç­‰ä»·äº <code>pat_param</code></li><li><code>expr</code>: ä¸€ä¸ª <a href="https://doc.rust-lang.org/reference/expressions.html" target="_blank" rel="noreferrer">è¡¨è¾¾å¼</a></li><li><code>ty</code>: ä¸€ç§ <a href="https://doc.rust-lang.org/reference/types.html#type-expressions" target="_blank" rel="noreferrer">ç±»å‹</a></li><li><code>ident</code>: ä¸€ä¸ª <a href="https://doc.rust-lang.org/reference/identifiers.html" target="_blank" rel="noreferrer">æ ‡è¯†ç¬¦æˆ–å…³é”®å­—</a></li><li><code>path</code>: ä¸€æ¡ <a href="https://doc.rust-lang.org/reference/paths.html#paths-in-types" target="_blank" rel="noreferrer">TypePath</a> å½¢å¼çš„è·¯å¾„</li><li><code>tt</code>: <a href="https://doc.rust-lang.org/reference/macros.html#macro-invocation" target="_blank" rel="noreferrer">Token æ ‘</a> ï¼ˆä¸€ä¸ªç‹¬ç«‹çš„ <a href="https://doc.rust-lang.org/reference/tokens.html" target="_blank" rel="noreferrer">token</a> æˆ–ä¸€ç³»åˆ—åœ¨åŒ¹é…å®Œæ•´çš„å®šç•Œç¬¦ <code>()</code>ã€<code>[]</code> æˆ– <code>{}</code> ä¸­çš„ tokenï¼‰</li><li><code>meta</code>: <a href="https://doc.rust-lang.org/reference/attributes.html" target="_blank" rel="noreferrer">æ ‡ç­¾</a> ä¸­çš„å†…å®¹</li><li><code>lifetime</code>: ä¸€ä¸ª <a href="https://doc.rust-lang.org/reference/tokens.html#lifetimes-and-loop-labels" target="_blank" rel="noreferrer">ç”Ÿå‘½å‘¨æœŸæ ‡è¯†</a></li><li><code>vis</code>: å¯èƒ½ä¸å­˜åœ¨çš„ <a href="https://doc.rust-lang.org/reference/visibility-and-privacy.html" target="_blank" rel="noreferrer">å¯è§æ€§æ ‡è®°</a>ï¼ˆå¹¶ä¸æ˜¯æ‰€æœ‰å‡½æ•°ã€ç±»å‹éƒ½ä¼šä½¿ç”¨ <code>pub</code> è¿›è¡Œæ ‡è®°ï¼Œæ‰€ä»¥å¯èƒ½æ˜¯ä¸å­˜åœ¨çš„ï¼‰</li><li><code>literal</code>: åŒ¹é… <a href="https://doc.rust-lang.org/reference/expressions/literal-expr.html" target="_blank" rel="noreferrer">æ–‡æœ¬è¡¨è¾¾å¼</a></li></ul><p>:::</p><h2 id="è¿‡ç¨‹å¼å®" tabindex="-1">è¿‡ç¨‹å¼å® <a class="header-anchor" href="#è¿‡ç¨‹å¼å®" aria-hidden="true">#</a></h2><p>ç¬¬äºŒç±»æ˜¯è¿‡ç¨‹å¼çš„å®ï¼Œå®ƒæ›´åƒå‡½æ•°ï¼Œä»–æ¥å—ä¸€äº›ä»£ç ä½œä¸ºå‚æ•°è¾“å…¥ï¼Œç„¶åå¯¹ä»–ä»¬è¿›è¡ŒåŠ å·¥ï¼Œç”Ÿæˆæ–°çš„ä»£ç ï¼Œä»–ä¸æ˜¯åœ¨åšå£°æ˜å¼å®é‚£æ ·çš„æ¨¡å¼åŒ¹é…ã€‚ä¸‰ç§è¿‡ç¨‹å¼å®éƒ½æ˜¯è¿™ç§æ€è·¯ã€‚</p><p>ä¸èƒ½åœ¨åŸå§‹çš„crateä¸­ç›´æ¥å†™è¿‡ç¨‹å¼å®ï¼Œéœ€è¦æŠŠè¿‡ç¨‹å¼å®æ”¾åˆ°ä¸€ä¸ªå•ç‹¬çš„crateä¸­ï¼ˆä»¥åå¯èƒ½ä¼šæ¶ˆé™¤è¿™ç§çº¦å®šï¼‰ã€‚å®šä¹‰è¿‡ç¨‹å¼å®çš„æ–¹æ³•å¦‚ä¸‹ï¼š</p><div class="language-rust"><button title="Copy Code" class="copy"></button><span class="lang">rust</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">use</span><span style="color:#FFCB6B;"> proc_macro</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">#[</span><span style="color:#A6ACCD;">some_attribute</span><span style="color:#89DDFF;">]</span></span>
<span class="line"><span style="color:#F78C6C;">pub</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">fn</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">some_name</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">input</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">TokenStream</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">-&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">TokenStream</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><p>éœ€è¦å¼•å…¥<code>proc_macro</code> è¿™ä¸ª crateï¼Œç„¶åæ ‡ç­¾æ˜¯ç”¨æ¥å£°æ˜å®ƒæ˜¯å“ªç§è¿‡ç¨‹å¼å®çš„ï¼Œæ¥ç€å°±æ˜¯ä¸€ä¸ªå‡½æ•°å®šä¹‰ï¼Œå‡½æ•°æ¥å— <code>TokenStream</code>ï¼Œè¿”å› <code>TokenStream</code>ã€‚<code>TokenStream</code> ç±»å‹å°±å®šä¹‰åœ¨ <code>proc_macro</code> åŒ…ä¸­ï¼Œè¡¨ç¤º token åºåˆ—ã€‚é™¤äº†æ ‡å‡†åº“ä¸­çš„è¿™ä¸ªåŒ…ï¼Œè¿˜å¯ä»¥ä½¿ç”¨<code>proc_macro2</code> åŒ…ï¼Œä½¿ç”¨ <code>proc_macro2::TokenStream::from()</code> å’Œ <code>proc_macro::TokenStream::from()</code> å¯ä»¥å¾ˆä¾¿æ·åœ°åœ¨ä¸¤ä¸ªåŒ…çš„ç±»å‹é—´è¿›è¡Œè½¬æ¢ã€‚ä½¿ç”¨ <code>proc_macro2</code> çš„å¥½å¤„æ˜¯å¯ä»¥åœ¨è¿‡ç¨‹å®å¤–éƒ¨ä½¿ç”¨ <code>proc_macro2</code> çš„ç±»å‹ï¼Œç›¸å <code>proc_macro</code> ä¸­çš„ç±»å‹åªå¯ä»¥åœ¨è¿‡ç¨‹å®çš„ä¸Šä¸‹æ–‡ä¸­ä½¿ç”¨ã€‚ä¸” <code>proc_macro2</code> å†™å‡ºçš„å®æ›´å®¹æ˜“ç¼–å†™æµ‹è¯•ä»£ç ã€‚</p><p>ä¸‹é¢è¯¦ç»†è¯´æ˜å¦‚ä½•å®šä¹‰ä¸‰ç±»è¿‡ç¨‹å®ã€‚</p><h3 id="custom-derive-å®" tabindex="-1">Custom Derive å® <a class="header-anchor" href="#custom-derive-å®" aria-hidden="true">#</a></h3><p>åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬çš„ç›®çš„æ˜¯å®ç°ä¸‹é¢çš„ä»£ç ï¼Œä½¿ç”¨ç¼–è¯‘å™¨ä¸ºæˆ‘ä»¬ç”Ÿæˆåä¸º <code>HelloMacro</code> çš„ <code>Trait</code></p><div class="language-rust"><button title="Copy Code" class="copy"></button><span class="lang">rust</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">use</span><span style="color:#FFCB6B;"> hello_macro</span><span style="color:#89DDFF;">::</span><span style="color:#FFCB6B;">HelloMacro</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F78C6C;">use</span><span style="color:#FFCB6B;"> hello_macro_derive</span><span style="color:#89DDFF;">::</span><span style="color:#FFCB6B;">HelloMacro</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">#[</span><span style="color:#A6ACCD;">derive</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">HelloMacro</span><span style="color:#89DDFF;">)]</span></span>
<span class="line"><span style="color:#C792EA;">struct</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Pancakes</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C;">fn</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">main</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#FFCB6B;">Pancakes</span><span style="color:#89DDFF;">::</span><span style="color:#82AAFF;">hello_macro</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><p>è¯¥ <code>Trait</code> çš„å®šä¹‰å¦‚ä¸‹ï¼Œç›®çš„æ˜¯æ‰“å°å®ç°è¯¥å®çš„ç±»å‹å</p><div class="language-rust"><button title="Copy Code" class="copy"></button><span class="lang">rust</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">pub</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">trait</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">HelloMacro</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">fn</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">hello_macro</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><p>ç”±äºè¿‡ç¨‹å®ä¸èƒ½åœ¨åŸ crate ä¸­å®ç°ï¼Œæˆ‘ä»¬éœ€è¦å¦‚ä¸‹åœ¨ <code>hello_crate</code> çš„ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ª <code>hello_macro_derive</code> crate</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#FFCB6B;">cargo</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">hello_macro_derive</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--lib</span></span>
<span class="line"></span></code></pre></div><p>åœ¨æ–°çš„ crate å†…ï¼Œæˆ‘ä»¬éœ€è¦ä¿®æ”¹ <code>Cargo.toml</code> é…ç½®æ–‡ä»¶ï¼Œ</p><div class="language-toml"><button title="Copy Code" class="copy"></button><span class="lang">toml</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#89DDFF;">[</span><span style="color:#FFCB6B;">lib</span><span style="color:#89DDFF;">]</span></span>
<span class="line"><span style="color:#A6ACCD;">proc-macro </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#FF9CAC;">true</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#FFCB6B;">dependencies</span><span style="color:#89DDFF;">]</span></span>
<span class="line"><span style="color:#A6ACCD;">syn </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">1.0</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">quote </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">1.0</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"></span></code></pre></div><p>åœ¨ <code>src/lib.rs</code> ä¸­å¯ä»¥ç€æ‰‹å®ç°è¯¥å®ï¼Œå…¶ä¸­ <code>syn</code> æ˜¯ç”¨æ¥è§£æ rust ä»£ç çš„ï¼Œè€Œquoteåˆ™å¯ä»¥ç”¨å·²æœ‰çš„å˜é‡ç”Ÿæˆä»£ç çš„ <code>TokenStream</code>ï¼Œå¯ä»¥è®¤ä¸º <code>quote!</code> å®å†…çš„å°±æ˜¯æˆ‘ä»¬æƒ³è¦ç”Ÿæˆçš„ä»£ç </p><div class="language-rust"><button title="Copy Code" class="copy"></button><span class="lang">rust</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#C792EA;">extern</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">crate</span><span style="color:#A6ACCD;"> proc_macro</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C;">use</span><span style="color:#FFCB6B;"> proc_macro</span><span style="color:#89DDFF;">::</span><span style="color:#FFCB6B;">TokenStream</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F78C6C;">use</span><span style="color:#FFCB6B;"> quote</span><span style="color:#89DDFF;">::</span><span style="color:#FFCB6B;">quote</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F78C6C;">use</span><span style="color:#FFCB6B;"> syn</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">#[</span><span style="color:#A6ACCD;">proc_macro_derive</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">HelloMacro</span><span style="color:#89DDFF;">)]</span></span>
<span class="line"><span style="color:#F78C6C;">pub</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">fn</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">hello_macro_derive</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">input</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">TokenStream</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">-&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">TokenStream</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">    // Construct a representation of Rust code as a syntax tree</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">    // that we can manipulate</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">let</span><span style="color:#A6ACCD;"> ast </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">syn</span><span style="color:#89DDFF;">::</span><span style="color:#82AAFF;">parse</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">input</span><span style="color:#89DDFF;">).</span><span style="color:#82AAFF;">unwrap</span><span style="color:#89DDFF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">    // Build the trait implementation</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#82AAFF;">impl_hello_macro</span><span style="color:#89DDFF;">(&amp;</span><span style="color:#A6ACCD;">ast</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C;">fn</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">impl_hello_macro</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">ast</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&amp;</span><span style="color:#FFCB6B;">syn</span><span style="color:#89DDFF;">::</span><span style="color:#FFCB6B;">DeriveInput</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">-&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">TokenStream</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">let</span><span style="color:#A6ACCD;"> name </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&amp;</span><span style="color:#A6ACCD;">ast</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">ident</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">let</span><span style="color:#A6ACCD;"> gen </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">quote!</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F78C6C;">impl</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">HelloMacro</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">for</span><span style="color:#A6ACCD;"> #name </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#F78C6C;">fn</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">hello_macro</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#82AAFF;">println!</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Hello, Macro! My name is </span><span style="color:#89DDFF;">{}</span><span style="color:#C3E88D;">!</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">stringify!</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">#name</span><span style="color:#89DDFF;">));</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">};</span></span>
<span class="line"><span style="color:#A6ACCD;">    gen</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">into</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><p>å¦å¤–ï¼Œ<strong>Custom Derive å®å¯ä»¥æºå¸¦Attributesï¼Œç§°ä¸º Derive macro helper attributes</strong>ï¼Œå…·ä½“ç¼–å†™æ–¹æ³•å¯ä»¥å‚è€ƒ <a href="https://doc.rust-lang.org/reference/procedural-macros.html#derive-macro-helper-attributes" target="_blank" rel="noreferrer">Reference</a>ï¼ˆRust ä¸­å…±æœ‰<a href="https://doc.rust-lang.org/reference/attributes.html" target="_blank" rel="noreferrer">å››ç±» Attributes</a>ï¼‰ã€‚å…³äº Derive macro helper attributes è¿™é‡Œæœ‰ä¸€ä¸ªå‘å°±æ˜¯<strong>åœ¨ä½¿ç”¨ <code>cfg_attr</code> æ—¶ï¼Œéœ€è¦æŠŠ Attributes æ”¾åœ¨å®ä¹‹å‰ã€‚</strong></p><p>ä¸¾ä¸ªæ —å­ï¼š</p><p>ä½¿ç”¨ kube-rs å¯ä»¥å¾ˆæ–¹ä¾¿åœ°å®šä¹‰ CRDï¼ˆCustom Resource Definitionï¼‰ï¼š</p><div class="language-rust"><button title="Copy Code" class="copy"></button><span class="lang">rust</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#89DDFF;">#[</span><span style="color:#A6ACCD;">derive</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">CustomResource</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Clone</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Debug</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Deserialize</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Serialize</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">JsonSchema</span><span style="color:#89DDFF;">)]</span></span>
<span class="line"><span style="color:#89DDFF;">#[</span><span style="color:#A6ACCD;">kube</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">group </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">clux.dev</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> version </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">v1</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> kind </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Foo</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> namespaced</span><span style="color:#89DDFF;">)]</span></span>
<span class="line"><span style="color:#C792EA;">struct</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">FooSpec</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    info</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">String</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><p>æˆ‘ç¬¬ä¸€ååº”æ˜¯ <code>#[kube]</code> æ˜¯ä¸€ä¸ª Attribute-Like å®ï¼Œä½†æ˜¯æŸ¥é˜… kube-rs æ–‡æ¡£æ‰å‘ç°å®ƒå…¶å®æ˜¯ <code>CustomResource</code> Custom Derive å®çš„ Attributeã€‚è¿™é‡Œæˆ‘ä»¬æƒ³ç”¨ <code>cfg_attr</code> æ¥æ§åˆ¶æ˜¯å¦å»åš deriveï¼Œä¸€å¼€å§‹å°±æƒ³å½“ç„¶åœ°è¿™ä¹ˆå†™äº†ï¼š</p><div class="language-rust"><button title="Copy Code" class="copy"></button><span class="lang">rust</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#89DDFF;">#[</span><span style="color:#A6ACCD;">cfg_attr</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">feature</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">use_kube_rs</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    derive</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">CustomResource</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Clone</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Debug</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Deserialize</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Serialize</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">JsonSchema</span><span style="color:#89DDFF;">),</span></span>
<span class="line"><span style="color:#A6ACCD;">    kube</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">group </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">clux.dev</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> version </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">v1</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> kind </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Foo</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> namespaced</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#89DDFF;">)]</span></span>
<span class="line"><span style="color:#C792EA;">struct</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">FooSpec</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    info</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">String</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><p>ç„¶è€Œè¿™æ˜¯é”™è¯¯çš„æ‰“å¼€æ–¹å¼ï¼Œéœ€è¦å†™æˆï¼š</p><div class="language-rust"><button title="Copy Code" class="copy"></button><span class="lang">rust</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#89DDFF;">#[</span><span style="color:#A6ACCD;">cfg_attr</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">feature</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">use_kube_rs</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    kube</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">group </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">clux.dev</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> version </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">v1</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> kind </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Foo</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> namespaced</span><span style="color:#89DDFF;">),</span></span>
<span class="line"><span style="color:#A6ACCD;">    derive</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">CustomResource</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Clone</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Debug</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Deserialize</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Serialize</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">JsonSchema</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#89DDFF;">)]</span></span>
<span class="line"><span style="color:#C792EA;">struct</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">FooSpec</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    info</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">String</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><p>Attributes éœ€è¦å†™åœ¨å®çš„ derive å‰é¢ã€‚</p><h3 id="attribute-like-å®" tabindex="-1">Attribute-Like å® <a class="header-anchor" href="#attribute-like-å®" aria-hidden="true">#</a></h3><p>attribute-like å®å’Œ custom derive å®å¾ˆç›¸ä¼¼ï¼Œåªæ˜¯æ ‡ç­¾å¯ä»¥è‡ªå®šä¹‰ï¼Œæ›´åŠ çµæ´»ï¼Œç”šè‡³å¯ä»¥ä½¿ç”¨åœ¨å‡½æ•°ä¸Šã€‚ä»–çš„ä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ï¼Œæ¯”å¦‚å‡è®¾æœ‰ä¸€ä¸ªå®ä¸º <code>route</code> çš„å®</p><div class="language-rust"><button title="Copy Code" class="copy"></button><span class="lang">rust</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#89DDFF;">#[</span><span style="color:#A6ACCD;">route</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">GET</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)]</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#F78C6C;">fn</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">index</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">...</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><p>æŒ‰ä¸‹é¢çš„è¯­æ³•å®šä¹‰ <code>route</code> å®</p><div class="language-rust"><button title="Copy Code" class="copy"></button><span class="lang">rust</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#89DDFF;">#[</span><span style="color:#A6ACCD;">proc_maco_attribute</span><span style="color:#89DDFF;">]</span></span>
<span class="line"><span style="color:#F78C6C;">pub</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">fn</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">route</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">attr</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">TokenStream</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> item</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">TokenStream</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">-&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">TokenStream</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">...</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><p>å…¶ä¸­ <code>attr</code> å‚æ•°æ˜¯ä¸Šé¢çš„ <code>Get</code>ï¼Œ<code>&quot;/&quot;</code> ï¼›<code>item</code> å‚æ•°æ˜¯ <code>fn index(){}</code> ã€‚</p><h3 id="function-like-å®" tabindex="-1">Function-Like å® <a class="header-anchor" href="#function-like-å®" aria-hidden="true">#</a></h3><p>è¿™ç§å®çœ‹ä¸Šå»å’Œ <code>macro_rules!</code> æ¯”è¾ƒç±»ä¼¼ï¼Œä½†æ˜¯åœ¨å£°æ˜å¼å®åªèƒ½ç”¨ <code>match</code> å»åšæ¨¡å¼åŒ¹é…ï¼Œä½†æ˜¯åœ¨è¿™é‡Œå¯ä»¥æœ‰æ›´å¤æ‚çš„è§£ææ–¹å¼ï¼Œæ‰€ä»¥å¯ä»¥å†™å‡ºæ¥</p><div class="language-rust"><button title="Copy Code" class="copy"></button><span class="lang">rust</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#C792EA;">let</span><span style="color:#A6ACCD;"> sql </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">sql!</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">SELECT </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> FROM posts WHERE id</span><span style="color:#89DDFF;">=</span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span></code></pre></div><p>ä¸Šé¢è¿™ä¸ª <code>sql</code> å®çš„å®šä¹‰æ–¹æ³•å¦‚ä¸‹</p><div class="language-rust"><button title="Copy Code" class="copy"></button><span class="lang">rust</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#89DDFF;">#[</span><span style="color:#A6ACCD;">proc_macro</span><span style="color:#89DDFF;">]</span></span>
<span class="line"><span style="color:#F78C6C;">pub</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">fn</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">sql</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">input</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">TokenStream</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">-&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">TokenStream</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">...</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><h2 id="å¥½ç”¨çš„åº“" tabindex="-1">å¥½ç”¨çš„åº“ <a class="header-anchor" href="#å¥½ç”¨çš„åº“" aria-hidden="true">#</a></h2><p><a href="https://doc.rust-lang.org/proc_macro/index.html" target="_blank" rel="noreferrer">proc_macro</a>ï¼šé»˜è®¤ token æµåº“ï¼Œåªèƒ½åœ¨è¿‡ç¨‹å®ä¸­ä½¿ç”¨ï¼Œç¼–è¯‘å™¨è¦ç”¨å®ƒï¼Œå°†å®ƒä½œä¸ºè¿‡ç¨‹å®çš„è¿”å›å€¼ï¼Œå¤§å¤šæ•°æƒ…å†µæˆ‘ä»¬ä¸éœ€è¦ï¼Œåªéœ€è¦åœ¨å®è¿”å›ç»“æœçš„æ—¶å€™æŠŠ <code>proc_macro2::TokenSteam</code> çš„æµ <code>into()</code> åˆ° <code>proc_macro::TokenSteam</code> å°±è¡Œäº†ã€‚</p><p><a href="https://crates.io/crates/proc_macro2" target="_blank" rel="noreferrer">proc_macro2</a>ï¼šæˆ‘ä»¬çœŸæ­£åœ¨ä½¿ç”¨çš„è¿‡ç¨‹å®åº“ï¼Œå¯ä»¥åœ¨è¿‡ç¨‹å®å¤–ä½¿ç”¨ã€‚</p><p><a href="https://crates.io/crates/syn" target="_blank" rel="noreferrer">syn</a>ï¼šè¿‡ç¨‹å®å·¦æŠ¤æ³•ï¼Œå¯ä»¥å°† <code>TokenStream</code> è§£ææˆè¯­æ³•æ ‘ï¼Œæ³¨æ„ä¸¤ä¸ª <code>proc_macro</code> å’Œ <code>proc_macro</code> éƒ½æ”¯æŒï¼Œéœ€è¦çœ‹æ–‡æ¡£ææ¸…æ¥šåº“å‡½æ•°åˆ°åº•æ˜¯åœ¨è§£æå“ªä¸ªåº“ä¸­çš„ <code>TokenStream</code>ã€‚</p><p><a href="https://crates.io/crates/quote" target="_blank" rel="noreferrer">quote</a>ï¼šè¿‡ç¨‹å®å³æŠ¤æ³•ï¼Œå°†è¯­æ³•æ ‘è§£ææˆ <code>TokenStream</code>ã€‚åªè¦ä¸€ä¸ª <code>quote!{}</code> å°±å¤Ÿäº†ï¼<code>quote!{}</code> å®å†…éƒ½æ˜¯å­—é¢é‡ï¼Œå³çº¯çº¯çš„ä»£ç ï¼Œè¦æ›¿æ¢è¿›å»çš„å˜é‡æ˜¯ç”¨çš„ <code>#</code> ç¬¦å·æ ‡æ³¨ï¼Œä¸ºäº†å’Œå£°æ˜å®ä¸­ä½¿ç”¨çš„ <code>$</code> ç›¸åŒºåˆ†ï¼ˆä¹Ÿå°±æ„å‘³ç€ç”¨ <code>quote</code> å†™è¿‡ç¨‹å®çš„æ—¶å€™ï¼Œå¯ä»¥å’Œå£°æ˜å®ç»“åˆ ğŸ¤¤ ï¼‰ã€‚æ¨¡å¼åŒ¹é…æ—¶ç”¨åˆ°çš„è¡¨ç¤ºé‡å¤çš„ç¬¦å·å’Œå£°æ˜å®ä¸­ä¸€æ ·ï¼Œæ˜¯ä½¿ç”¨ <code>*</code>ã€‚</p><p><a href="https://crates.io/crates/darling" target="_blank" rel="noreferrer">darling</a> å¥½ç”¨åˆ°è·º jio jio çš„æ ‡ç­¾å®è§£æåº“ï¼Œè®©äººç›´å‘¼ Darlingï¼</p><h2 id="macrokata" tabindex="-1">MacroKata <a class="header-anchor" href="#macrokata" aria-hidden="true">#</a></h2><p>2022å¹´12æœˆæ›´æ–°</p><p>çœ‹åˆ°äº†ä¸€ä¸ªå®æ•™ç¨‹é¡¹ç›® <a href="https://tfpk.github.io/macrokata/" target="_blank" rel="noreferrer">MacroKata</a>ï¼Œåˆ·äº†ä¸€ä¸‹ï¼Œç›®å‰<strong>æ•™ç¨‹ä¸­ä»…åŒ…å«å£°æ˜å¼çš„å®</strong>ï¼Œè¯»åˆ°äº†ä¸€äº›ä¹‹å‰æ²¡æ³¨æ„çš„ç‚¹ã€‚</p><p>å¯¹äºå£°æ˜å¼å®ï¼š</p><ul><li><p>é™¤äº†<code>$ </code>å’Œåˆ†éš”ç¬¦ï¼ˆ<code>{}</code>ã€<code>()</code>ã€<code>[]</code>ï¼‰å¤–ä»»æ„tokenéƒ½å¯ä»¥ç”¨åœ¨æ¨¡å¼é‡Œé¢ï¼Œå¦‚</p><div class="language-rust"><button title="Copy Code" class="copy"></button><span class="lang">rust</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#82AAFF;">macro_rules!</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">math</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">($</span><span style="color:#A6ACCD;">a</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;">literal plus </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">b</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;">literal</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">a</span><span style="color:#89DDFF;">+$</span><span style="color:#A6ACCD;">b</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">};</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">square </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">a</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;">literal</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">a</span><span style="color:#89DDFF;">*$</span><span style="color:#A6ACCD;">a</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">};</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div></li><li><p>æŠŠå®åŒ…è£…æˆå‡½æ•°æ¥å£å¯ä»¥é¿å…è¢« <code>cargo expand</code> å±•å¼€ï¼Œæ¯”å¦‚æ•™ç¨‹ä¸­ä¸ºäº†ç®€æ´ï¼Œå°±å°½å¯èƒ½æŠŠ <code>println!</code> å•ç‹¬åŒ…è£…åˆ°äº†å‡½æ•°é‡Œ</p><blockquote><p>However, <code>macrokata</code> tries to avoid (as much as possible) using macros we didn&#39;t define inside the main function. The reason for this is that, if we did use <code>println!</code> you would see its expansion as well.</p></blockquote></li><li><p>é‡å¤çš„å‚æ•°æ¨¡å¼åªå¯ä»¥æ”¾åˆ°æœ«å°¾ï¼Œé™¤éæœ‰æ˜ç¡®çš„åˆ†éš”ç¬¦ï¼Œå¦åˆ™ä¸çŸ¥é“åˆ°åº•åŒ¹é…å¤šå°‘ä¸ªï¼Œä¼šå¸¦æ¥æ­§ä¹‰ã€‚æ¯”å¦‚ä¸‹é¢è¿™ä¸ªä¾‹å­ï¼Œæƒ³è¦è¡¨è¾¾è‡³å°‘æœ‰ä¸¤ä¸ªå‚æ•°ã€‚ç¬¬ä¸€ç§æ˜¯ä¸å¯è¡Œçš„ï¼Œå› ä¸ºåœ¨åŒ¹é…è§„åˆ™çš„æ—¶å€™æ— æ³•å¾€åçœ‹æ˜¯å¦æ˜¯æœ€åä¸€ä¸ªå‚æ•°ã€‚</p><div class="language-rust"><button title="Copy Code" class="copy"></button><span class="lang">rust</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">// wrong! </span></span>
<span class="line"><span style="color:#82AAFF;">macro_rules!</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">sum</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">($($</span><span style="color:#A6ACCD;">expr</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;">expr</span><span style="color:#89DDFF;">),+</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">lastexpr</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;">expr</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">$($</span><span style="color:#A6ACCD;">expr </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">)+</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">lastexpr</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// right!</span></span>
<span class="line"><span style="color:#82AAFF;">macro_rules!</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">sum</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">($</span><span style="color:#A6ACCD;">lastexpr</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;">expr</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">$($</span><span style="color:#A6ACCD;">expr</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;">expr</span><span style="color:#89DDFF;">),+)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">lastexpr </span><span style="color:#89DDFF;">$(+$</span><span style="color:#A6ACCD;">expr</span><span style="color:#89DDFF;">)+</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div></li><li><p>å£°æ˜å¼çš„å®çš„åŒ¹é…å¸¦æœ‰é¡ºåºï¼ŒåŒ¹é…åˆ°åˆæ³•é¡¹åå°±ä¸ä¼šç»§ç»­åŒ¹é…äº†ï¼Œæ¯”å¦‚ä¸‹é¢è¿™ä¸ªä¾‹å­ä¸­ï¼Œ <code>&#39;a&#39;</code> æ˜¯ä¸€ä¸ªå­—é¢é‡ï¼Œä½†æ˜¯åŒ¹é…åˆ°äº†ç¬¬ä¸€æ¡ï¼Œå¯¼è‡´ç¬¬äºŒæ¡æ›´åŠ ä¸¥æ ¼çš„æ¨¡å¼æ²¡æœ‰è¢«åŒ¹é…åˆ°ã€‚</p><div class="language-rust"><button title="Copy Code" class="copy"></button><span class="lang">rust</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#82AAFF;">macro_rules!</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">ordering</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">($</span><span style="color:#A6ACCD;">j</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;">expr</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">This was an expression</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">};</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">($</span><span style="color:#A6ACCD;">j</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;">literal</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">This was a literal</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">};</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">let</span><span style="color:#A6ACCD;"> expr1 </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">ordering!</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">a</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">);</span><span style="color:#676E95;font-style:italic;">  // =&gt; &quot;This was an expression&quot;.</span></span>
<span class="line"><span style="color:#C792EA;">let</span><span style="color:#A6ACCD;"> expr1 </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">ordering!</span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">3</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">5</span><span style="color:#89DDFF;">);</span><span style="color:#676E95;font-style:italic;">  // =&gt; &quot;This was an expression&quot;.</span></span>
<span class="line"></span></code></pre></div></li><li><p>åµŒå¥—çš„é‡å¤çš„å‚æ•°ï¼š<code>( $( $( $val:expr ),+ );+ )</code>ï¼Œå½“ç„¶ separator å¯ä»¥éšä¾¿æ›¿æ¢æˆä»»æ„é™¤<code>*</code>ã€<code>+</code>ã€<code>?</code>ï¼ˆè¿™ä¸‰ä¸ªç”¨äºæ¨¡å¼é‡Œé¢è¡¨ç¤ºé‡å¤æ¬¡æ•°ï¼Œæ‰€ä»¥ä¼šå¸¦æ¥æ­§ä¹‰ï¼‰ã€<code>$</code>ã€åˆ†éš”ç¬¦ä¹‹å¤–çš„tokenã€‚</p></li><li><p>å£°æ˜å¼å®è°ƒç”¨å£°æ˜å¼å®çš„æ—¶å€™ï¼Œå†…éƒ¨çš„å®èƒ½å¤Ÿçœ‹åˆ°çš„ASTæ˜¯ä¸é€æ˜çš„ï¼Œå› æ­¤ä¸€èˆ¬åªèƒ½å’Œå¤–ç•Œé‡‡ç”¨ç›¸åŒçš„å‚æ•°ç±»å‹ã€‚ä½†æ˜¯<code>ident</code>ã€<code>lifetime</code>ã€<code>tt</code>æ¯”è¾ƒç‰¹æ®Šï¼Œå¯ä»¥è¢«å†…éƒ¨çš„<code>literal</code> åŒ¹é…ã€‚å¦‚ä¸‹é¢è¿™ä¸ªä¾‹å­</p><div class="language-rust"><button title="Copy Code" class="copy"></button><span class="lang">rust</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#82AAFF;">macro_rules!</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">foo</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">($</span><span style="color:#A6ACCD;">l</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;">expr</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">bar!</span><span style="color:#89DDFF;">($</span><span style="color:#A6ACCD;">l</span><span style="color:#89DDFF;">);</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// ERROR:               ^^ no rules expected this token in macro call</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#82AAFF;">macro_rules!</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">bar</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">3</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#82AAFF;">foo!</span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">3</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// compiles OK</span></span>
<span class="line"><span style="color:#82AAFF;">macro_rules!</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">foo</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">($</span><span style="color:#A6ACCD;">l</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;">tt</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">bar!</span><span style="color:#89DDFF;">($</span><span style="color:#A6ACCD;">l</span><span style="color:#89DDFF;">);</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#82AAFF;">macro_rules!</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">bar</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">3</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#82AAFF;">foo!</span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">3</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span></code></pre></div></li><li><p>å®å¯ä»¥é€’å½’ï¼Œæ¯”å¦‚ä¸‹é¢è¿™ä¸ªå®</p><div class="language-rust"><button title="Copy Code" class="copy"></button><span class="lang">rust</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#C792EA;">enum</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">LinkedList</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#82AAFF;">Node</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">i32</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Box</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">LinkedList</span><span style="color:#89DDFF;">&gt;),</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#FFCB6B;">Empty</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#82AAFF;">macro_rules!</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">linked_list</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#FFCB6B;">LinkedList</span><span style="color:#89DDFF;">::</span><span style="color:#FFCB6B;">Empty</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">};</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">($</span><span style="color:#A6ACCD;">expr</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;">expr </span><span style="color:#89DDFF;">$(,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">exprs</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;">expr</span><span style="color:#89DDFF;">)*)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#FFCB6B;">LinkedList</span><span style="color:#89DDFF;">::</span><span style="color:#82AAFF;">Node</span><span style="color:#89DDFF;">($</span><span style="color:#A6ACCD;">expr</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Box</span><span style="color:#89DDFF;">::</span><span style="color:#82AAFF;">new</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">linked_list!</span><span style="color:#89DDFF;">($($</span><span style="color:#A6ACCD;">exprs</span><span style="color:#89DDFF;">),*)))</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C;">fn</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">main</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">let</span><span style="color:#A6ACCD;"> my_list </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">linked_list!</span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">3</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">4</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">5</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><p>ä½†æ˜¯å®é€’å½’å¾ˆæ…¢ï¼Œå› æ­¤é»˜è®¤ rustc ä¼šæœ‰ 128 å±‚çš„é™åˆ¶ï¼Œå¯ä»¥åœ¨åŒ…å±‚é¢é…ç½®æ ‡ç­¾ <code>#![recursion_limit = &quot;256&quot;]</code>ã€‚</p></li></ul><h2 id="æ”¶å½•æœ‰è¶£çš„å®æ ·ä¾‹" tabindex="-1">æ”¶å½•æœ‰è¶£çš„å®æ ·ä¾‹ <a class="header-anchor" href="#æ”¶å½•æœ‰è¶£çš„å®æ ·ä¾‹" aria-hidden="true">#</a></h2><p>æœ¬ç« æ”¶å½•åˆ°çš„å®å°½å¯èƒ½çŸ­å°ã€ç‹¬ç«‹ã€æœ‰è¶£ã€‚</p><h3 id="ä½ è¿™å†™çš„å•¥å•Š" tabindex="-1">ä½ è¿™å†™çš„å•¥å•Š <a class="header-anchor" href="#ä½ è¿™å†™çš„å•¥å•Š" aria-hidden="true">#</a></h3><p>è®°å½•ä¸€ä¸‹è‡ªå·±å†™çš„ä¸€äº›æœ‰è¶£çš„å®ï¼Œä»¥é˜²ä¸‹æ¬¡ç¢°åˆ°è¿™ç§æƒ…å†µå¿˜è®°å’‹å†™ã€‚</p><ul><li><p>è¿™é‡Œçš„å®é™…éœ€æ±‚æ˜¯å¤„ç†æ ‡ç­¾å®å‚æ•°ï¼Œç”¨äº† <a href="https://crates.io/crates/darling" target="_blank" rel="noreferrer">darling</a> åº“åšè§£æï¼Œç„¶åå¤„ç†ä¸€äº› <code>Option</code> ç±»å‹çš„å¯é€‰å‚æ•°ï¼Œå¦‚æœæ ‡ç­¾å®å‚æ•°ä¸­æ²¡æœ‰å®ƒï¼ˆå³ <code>darling</code> è§£æå‡º <code>None</code>ï¼‰ï¼Œå°±ä¸ç†ä¼šå®ƒï¼Œåœ¨åç»­æ„é€ ä¸­ä½¿ç”¨é»˜è®¤å€¼ã€‚æ„Ÿè§‰æœ‰æ„æ€çš„åœ°æ–¹åœ¨äºè¿‡ç¨‹å®å’Œå£°æ˜å®çš„æ··åˆä½¿ç”¨ï¼Œåœ¨å†™å‡ºæ¥ä¹‹å‰æˆ‘æ²¡æƒ³åˆ°è¿™ä¹ˆå†™çœŸèƒ½è·‘ = =</p><div class="language-rust"><button title="Copy Code" class="copy"></button><span class="lang">rust</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#82AAFF;">macro_rules!</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">expand_attribute</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">($($</span><span style="color:#A6ACCD;">attr</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;">expr</span><span style="color:#89DDFF;">),*)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#C792EA;">let</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">mut</span><span style="color:#A6ACCD;"> token </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">TokenStream2</span><span style="color:#89DDFF;">::</span><span style="color:#82AAFF;">new</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;">$(</span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">let</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Some</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">val</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">attr </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">                token</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">extend</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">quote!</span><span style="color:#89DDFF;">{$</span><span style="color:#A6ACCD;">attr</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> #val</span><span style="color:#89DDFF;">,});</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;">})*</span></span>
<span class="line"><span style="color:#A6ACCD;">            token</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">};</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><p>ä½¿ç”¨æ—¶æ˜¯è¿™ä¹ˆç”¨çš„</p><div class="language-rust"><button title="Copy Code" class="copy"></button><span class="lang">rust</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">use</span><span style="color:#FFCB6B;"> darling</span><span style="color:#89DDFF;">::</span><span style="color:#FFCB6B;">FromMeta</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">#[</span><span style="color:#A6ACCD;">derive</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">Debug</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">FromMeta</span><span style="color:#89DDFF;">)]</span></span>
<span class="line"><span style="color:#C792EA;">struct</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Attrs</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">#[</span><span style="color:#A6ACCD;">darling</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">default</span><span style="color:#89DDFF;">)]</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">pub</span><span style="color:#A6ACCD;"> param1</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Option</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">f64</span><span style="color:#89DDFF;">&gt;,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">#[</span><span style="color:#A6ACCD;">darling</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">default</span><span style="color:#89DDFF;">)]</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">pub</span><span style="color:#A6ACCD;"> param2</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Option</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">f64</span><span style="color:#89DDFF;">&gt;,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">#[</span><span style="color:#A6ACCD;">darling</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">default</span><span style="color:#89DDFF;">)]</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">pub</span><span style="color:#A6ACCD;"> param3</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Option</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">f64</span><span style="color:#89DDFF;">&gt;,</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">#[</span><span style="color:#A6ACCD;">derive</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">Debug</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Default</span><span style="color:#89DDFF;">)]</span></span>
<span class="line"><span style="color:#C792EA;">struct</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Struct</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">pub</span><span style="color:#A6ACCD;"> param1</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">f64</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">pub</span><span style="color:#A6ACCD;"> param2</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">f64</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">pub</span><span style="color:#A6ACCD;"> neccessary</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">String</span><span style="color:#89DDFF;">,</span><span style="color:#676E95;font-style:italic;"> // cannot be empty or any default value</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">#[</span><span style="color:#A6ACCD;">proc_macro_attribute</span><span style="color:#89DDFF;">]</span></span>
<span class="line"><span style="color:#F78C6C;">pub</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">fn</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">an_attribute</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">attr</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">TokenStream</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> item</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">TokenStream</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">-&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">TokenStream</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">let</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Attrs</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        param1</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#A6ACCD;">        param2</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">...</span><span style="color:#676E95;font-style:italic;"> // Attrs::param3 is not useful in Struct</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;font-style:italic;">match</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Attrs</span><span style="color:#89DDFF;">::</span><span style="color:#82AAFF;">from_list</span><span style="color:#89DDFF;">(&amp;</span><span style="color:#A6ACCD;">attr</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#FFCB6B;">Ok</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">v</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> v</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#FFCB6B;">Err</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">e</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">TokenStream</span><span style="color:#89DDFF;">::</span><span style="color:#82AAFF;">from</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">e</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">write_errors</span><span style="color:#89DDFF;">());</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">};</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">let</span><span style="color:#A6ACCD;"> optional_params </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">expand_attribute!</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">param1</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> param2</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">let</span><span style="color:#A6ACCD;"> build_a_struct </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">quote!</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#FFCB6B;">Struct</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">            neccessary</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">0817</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#A6ACCD;">            #optional_params</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;">..</span><span style="color:#FFCB6B;">Default</span><span style="color:#89DDFF;">::</span><span style="color:#82AAFF;">default</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">};</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">    // TL;DR</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><p>çœ‹å¾—å‡ºæ¥è¿˜æ˜¯æ¯”è¾ƒç¹ççš„ï¼Œ</p></li><li><p>è¿™é‡Œçš„å®é™…éœ€æ±‚æ˜¯ç”¨æ ‡ç­¾å®ä¿®æ”¹åŸå‡½æ•°è¿”å›å€¼ä¸º Resultï¼Œæ˜¯åœ¨ <a href="https://github.com/sentinel-group/sentinel-rust" target="_blank" rel="noreferrer">sentinel-group/sentinel-rust</a> çš„å®ç°ä¸­ï¼Œç”¨æ¥å¿«é€Ÿç»™ä¸€ä¸ªå‡½æ•°æˆ–æ–¹æ³•åˆ›å»º sentinel çš„ã€‚å½“æ—¶çš„æƒ³æ³•æ˜¯ç”¨ Result æ¥è¡¨è¾¾æŸä¸ªæµæ˜¯å¦è¢«é˜»ç¢ï¼ŒåŒæ—¶å¯ä»¥ä¼ é€’ Sentinel çš„å‘Šè­¦ç»™ç”¨æˆ·ï¼Œå®ç°å‡ºæ¥çš„å¾ˆåƒåœ¾ï¼Œå¯ä»¥è¯´æ˜¯åªæ”¯æŒä½¿ç”¨ä¸€ä¸ªè§„åˆ™ã€‚æ²¡æœ‰è¯•è¿‡å¤šä¸ªè¿™æ ·çš„æ ‡ç­¾å®åµŒå¥—ï¼Œä½†æ˜¯ä¼°è®¡æ˜¯å›è°ƒåœ°ç‹±é‡ç°ä¸–é—´ ğŸ˜… ï¼ˆæˆ–è®¸å¯ä»¥ç”¨ <code>std::Result::flatten()</code> æ¥é¿å…ï¼Œä½†æ˜¯å®ƒç›®å‰è¿˜æ˜¯ nightly çš„ APIï¼‰ã€‚</p><p>è¿™é‡Œçš„å®ç°ä¹Ÿæœ‰ç‚¹è ¢ï¼Œæ˜¯ç”¨çš„ quote å’Œ syn è‡ªåŠ¨è§£æçš„ä¿®æ”¹åçš„å‡½æ•°ç­¾åï¼Œå°è¯•è¿‡æ‰‹åŠ¨æ„é€ ï¼Œä½†æ˜¯å¤ªæ¶å¿ƒäº†æ„é€ ä¸æ¥ã€‚</p><div class="language-rust"><button title="Copy Code" class="copy"></button><span class="lang">rust</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">pub</span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">crate</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">fn</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">process_func</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">mut</span><span style="color:#A6ACCD;"> func</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">ItemFn</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">-&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">ItemFn</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">let</span><span style="color:#A6ACCD;"> output </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> func</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">sig</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">output</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">    // Currently, use quote/syn to automatically generate it,</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">    // don&#39;t know if there is a better way.</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">    // Seems hard to parse new ReturnType only or construct ReturnType by hand.</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">let</span><span style="color:#A6ACCD;"> dummy_func </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">match</span><span style="color:#A6ACCD;"> output </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#FFCB6B;">ReturnType</span><span style="color:#89DDFF;">::</span><span style="color:#FFCB6B;">Default</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#82AAFF;">quote!</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#F78C6C;">fn</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">dummy</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">-&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Result</span><span style="color:#89DDFF;">&lt;(),</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">String</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{}</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#FFCB6B;">ReturnType</span><span style="color:#89DDFF;">::</span><span style="color:#82AAFF;">Type</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">_</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> return_type</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#82AAFF;">quote!</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#F78C6C;">fn</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">dummy</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">-&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Result</span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">#return_type</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">String</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{}</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">};</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">let</span><span style="color:#A6ACCD;"> dummy_func</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">ItemFn</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">syn</span><span style="color:#89DDFF;">::</span><span style="color:#82AAFF;">parse2</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">dummy_func</span><span style="color:#89DDFF;">).</span><span style="color:#82AAFF;">unwrap</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">    // replace the old ReturnType to the dummy function ReturnType</span></span>
<span class="line"><span style="color:#A6ACCD;">    func</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">sig</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">output </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> dummy_func</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">sig</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">output</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    func</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div></li></ul><h3 id="è¿˜å¾—å­¦ä¹ ä¸€ä¸ª" tabindex="-1">è¿˜å¾—å­¦ä¹ ä¸€ä¸ª <a class="header-anchor" href="#è¿˜å¾—å­¦ä¹ ä¸€ä¸ª" aria-hidden="true">#</a></h3><p>æœ¬ç« èŠ‚æŠ„å½•ä¸€äº›åˆ«äººå†™çš„é»‘é­”æ³•å®ã€‚</p><h4 id="macrokata-ä¸­çš„æŸ¯é‡ŒåŒ–ç¤ºä¾‹" tabindex="-1">MacroKata ä¸­çš„æŸ¯é‡ŒåŒ–ç¤ºä¾‹ <a class="header-anchor" href="#macrokata-ä¸­çš„æŸ¯é‡ŒåŒ–ç¤ºä¾‹" aria-hidden="true">#</a></h4><h5 id="åŒ¿åå‡½æ•°-è‡ªåŠ¨æ¨å¯¼è¿”å›ç±»å‹" tabindex="-1">åŒ¿åå‡½æ•° è‡ªåŠ¨æ¨å¯¼è¿”å›ç±»å‹ <a class="header-anchor" href="#åŒ¿åå‡½æ•°-è‡ªåŠ¨æ¨å¯¼è¿”å›ç±»å‹" aria-hidden="true">#</a></h5><p>é€šè¿‡å£°æ˜å¼å®çš„é€’å½’é€å±‚å±•å¼€</p><div class="language-rust"><button title="Copy Code" class="copy"></button><span class="lang">rust</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#82AAFF;">macro_rules!</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">curry</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">_</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">block</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;">block</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{$</span><span style="color:#A6ACCD;">block</span><span style="color:#89DDFF;">};</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">(($</span><span style="color:#A6ACCD;">argident</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;">ident </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">argtype</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;">ty</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">$(($</span><span style="color:#A6ACCD;">argidents</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;">ident</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">argtypes</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;">ty</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=&gt;)*</span><span style="color:#A6ACCD;"> _</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">block</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;">block</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F78C6C;">move</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|$</span><span style="color:#A6ACCD;">argident</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">argtype</span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#82AAFF;">print_curried_argument</span><span style="color:#89DDFF;">($</span><span style="color:#A6ACCD;">argident</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#82AAFF;">curry!</span><span style="color:#89DDFF;">($(($</span><span style="color:#A6ACCD;">argidents</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">argtypes</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=&gt;)*</span><span style="color:#A6ACCD;"> _</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">block</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">};</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><div class="language-rust"><button title="Copy Code" class="copy"></button><span class="lang">rust</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">fn</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">main</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">let</span><span style="color:#A6ACCD;"> is_between </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">curry!</span><span style="color:#89DDFF;">((</span><span style="color:#A6ACCD;">min</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">i32</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">max</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">i32</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">item</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&amp;</span><span style="color:#FFCB6B;">i32</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> _</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        min </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;">item </span><span style="color:#89DDFF;">&amp;&amp;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;">item </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;"> max</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">let</span><span style="color:#A6ACCD;"> curry_filter_between </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">curry!</span><span style="color:#89DDFF;">((</span><span style="color:#A6ACCD;">min</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">i32</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">max</span><span style="color:#89DDFF;">:</span><span style="color:#FFCB6B;">i32</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">vec</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&amp;</span><span style="color:#FFCB6B;">Vec</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">i32</span><span style="color:#89DDFF;">&gt;)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> _</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">let</span><span style="color:#A6ACCD;"> filter_between </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">is_between</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">min</span><span style="color:#89DDFF;">)(</span><span style="color:#A6ACCD;">max</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">        vec</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">iter</span><span style="color:#89DDFF;">().</span><span style="color:#82AAFF;">filter_map</span><span style="color:#89DDFF;">(|</span><span style="color:#A6ACCD;">i</span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">filter_between</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">i</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Some</span><span style="color:#89DDFF;">(*</span><span style="color:#A6ACCD;">i</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">else</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">None</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">}).</span><span style="color:#82AAFF;">collect</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">let</span><span style="color:#A6ACCD;"> between_3_7 </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">curry_filter_between</span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">3</span><span style="color:#89DDFF;">)(</span><span style="color:#F78C6C;">7</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">let</span><span style="color:#A6ACCD;"> between_5_10 </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">curry_filter_between</span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">5</span><span style="color:#89DDFF;">)(</span><span style="color:#F78C6C;">10</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">let</span><span style="color:#A6ACCD;"> my_vec </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">vec!</span><span style="color:#89DDFF;">[</span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">3</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">5</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">6</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">7</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">9</span><span style="color:#89DDFF;">];</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">    // 5,6</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">let</span><span style="color:#A6ACCD;"> some_numbers</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Vec</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">i32</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">between_3_7</span><span style="color:#89DDFF;">(&amp;</span><span style="color:#A6ACCD;">my_vec</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">    // 6,7,9</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">let</span><span style="color:#A6ACCD;"> more_numbers</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Vec</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">i32</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">between_5_10</span><span style="color:#89DDFF;">(&amp;</span><span style="color:#A6ACCD;">my_vec</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"></span></code></pre></div><h5 id="æ˜¾ç¤ºå†™å‡ºè¿”å›ç±»å‹" tabindex="-1">æ˜¾ç¤ºå†™å‡ºè¿”å›ç±»å‹ <a class="header-anchor" href="#æ˜¾ç¤ºå†™å‡ºè¿”å›ç±»å‹" aria-hidden="true">#</a></h5><p>ä¸‹é¢çš„<code>box_type!</code>å®åŒæ ·é€šè¿‡å£°æ˜å¼å®çš„é€’å½’æ„é€ å‡ºè¿”å›ç±»å‹</p><div class="language-rust"><button title="Copy Code" class="copy"></button><span class="lang">rust</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#82AAFF;">macro_rules!</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">curry_unwrapper</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">($</span><span style="color:#A6ACCD;">block</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;">block</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">block</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">};</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">argname</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;">ident</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">argtype</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;">ty</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">$($</span><span style="color:#A6ACCD;">argnames</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;">ident</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">argtypes</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;">ty</span><span style="color:#89DDFF;">,)*</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">block</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;">block</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#FFCB6B;">Box</span><span style="color:#89DDFF;">::</span><span style="color:#82AAFF;">new</span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">move</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|$</span><span style="color:#A6ACCD;">argname </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">argtype </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#82AAFF;">curry_unwrapper!</span><span style="color:#89DDFF;">($($</span><span style="color:#A6ACCD;">argnames</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">argtypes</span><span style="color:#89DDFF;">,)*</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">block</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">})</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#82AAFF;">macro_rules!</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">box_type</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">(=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">type</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;">ty</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">type</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">};</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">($</span><span style="color:#A6ACCD;">type</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;">ty </span><span style="color:#89DDFF;">$(,$</span><span style="color:#A6ACCD;">argtypes</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;">ty </span><span style="color:#89DDFF;">)*</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">restype</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;">ty</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#FFCB6B;">Box</span><span style="color:#89DDFF;">&lt;</span><span style="color:#F78C6C;">dyn</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Fn</span><span style="color:#89DDFF;">($</span><span style="color:#C792EA;">type</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">-&gt;</span><span style="color:#A6ACCD;"> box_type</span><span style="color:#89DDFF;">!($($</span><span style="color:#A6ACCD;">argtypes </span><span style="color:#89DDFF;">),*</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">restype</span><span style="color:#89DDFF;">)&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#82AAFF;">macro_rules!</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">curry_fn</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">ident</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;">ident</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">($</span><span style="color:#A6ACCD;">argname</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;">ident</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">argtype</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;">ty</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;">-&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">$(($</span><span style="color:#A6ACCD;">argnames</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;">ident</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">argtypes</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;">ty</span><span style="color:#89DDFF;">))-&gt;*</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">restype</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;">ty</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">block</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;">block</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F78C6C;">fn</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">ident</span><span style="color:#89DDFF;">($</span><span style="color:#A6ACCD;">argname</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">argtype</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">-&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">box_type!</span><span style="color:#89DDFF;">($($</span><span style="color:#A6ACCD;">argtypes </span><span style="color:#89DDFF;">),*</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">restype</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#82AAFF;">curry_unwrapper!</span><span style="color:#89DDFF;">($($</span><span style="color:#A6ACCD;">argnames</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">argtypes</span><span style="color:#89DDFF;">,)*</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">block</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C;">fn</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">main</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#82AAFF;">curry_fn!</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">add</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">a</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">i32</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">-&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">b</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">i32</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">-&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">c</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">i32</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">-&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">d</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">i32</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">i32</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        a </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> b </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> c </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> d</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">let</span><span style="color:#A6ACCD;"> res </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">add</span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">3</span><span style="color:#89DDFF;">)(</span><span style="color:#F78C6C;">2</span><span style="color:#89DDFF;">)(</span><span style="color:#F78C6C;">3</span><span style="color:#89DDFF;">)(</span><span style="color:#F78C6C;">4</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><h2 id="references" tabindex="-1">References <a class="header-anchor" href="#references" aria-hidden="true">#</a></h2><p><a href="https://doc.rust-lang.org/book/ch19-06-macros.html" target="_blank" rel="noreferrer">Macros - The Rust Programming Language (rust-lang.org)</a></p><p><a href="https://doc.rust-lang.org/reference/macros.html" target="_blank" rel="noreferrer">Macros - The Rust Reference</a></p><p><a href="https://danielkeep.github.io/tlborm/book/index.html" target="_blank" rel="noreferrer">The Little Book of Rust Macros</a></p><p><a href="https://dengjianping.github.io/2019/02/28/%E5%A6%82%E4%BD%95%E7%BC%96%E5%86%99%E4%B8%80%E4%B8%AA%E8%BF%87%E7%A8%8B%E5%AE%8F(proc-macro).html" target="_blank" rel="noreferrer">å¦‚ä½•ç¼–å†™ä¸€ä¸ªè¿‡ç¨‹å®(proc-macro)</a></p><p><a href="https://tfpk.github.io/macrokata/" target="_blank" rel="noreferrer">MacroKata - Exercises for Rust Macros</a></p>`,101),e=[o];function t(r,c,D,F,y,C){return n(),a("div",null,e)}const d=s(p,[["render",t]]);export{i as __pageData,d as default};
